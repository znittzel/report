(function(e,t,n){"use strict";var r=e.event,i,s;i=r.special.debouncedresize={setup:function(){e(this).on("resize",i.handler)},teardown:function(){e(this).off("resize",i.handler)},handler:function(e,t){var n=this,o=arguments,u=function(){e.type="debouncedresize";r.dispatch.apply(n,o)};if(s){clearTimeout(s)}t?u():s=setTimeout(u,i.threshold)},threshold:50};var o="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";e.fn.imagesLoaded=function(t){function c(){var n=e(f),s=e(l);if(i){if(l.length){i.reject(u,n,s)}else{i.resolve(u)}}if(e.isFunction(t)){t.call(r,u,n,s)}}function h(t,n){if(t.src===o||e.inArray(t,a)!==-1){return}a.push(t);if(n){l.push(t)}else{f.push(t)}e.data(t,"imagesLoaded",{isBroken:n,src:t.src});if(s){i.notifyWith(e(t),[n,u,e(f),e(l)])}if(u.length===a.length){setTimeout(c);u.unbind(".imagesLoaded")}}var r=this,i=e.isFunction(e.Deferred)?e.Deferred():0,s=e.isFunction(i.notify),u=r.find("img").add(r.filter("img")),a=[],f=[],l=[];if(e.isPlainObject(t)){e.each(t,function(e,n){if(e==="callback"){t=n}else if(i){i[e](n)}})}if(!u.length){c()}else{u.bind("load.imagesLoaded error.imagesLoaded",function(e){h(e.target,e.type==="error")}).each(function(t,r){var i=r.src;var s=e.data(r,"imagesLoaded");if(s&&s.src===i){h(r,s.isBroken);return}if(r.complete&&r.naturalWidth!==n){h(r,r.naturalWidth===0||r.naturalHeight===0);return}if(r.readyState||r.complete){r.src=o;r.src=i}})}return i?i.promise(r):r};var u=e(t),a=t.Modernizr;e.Slicebox=function(t,n){this.$el=e(n);this._init(t)};e.Slicebox.defaults={orientation:"v",perspective:1200,cuboidsCount:5,cuboidsRandom:false,maxCuboidsCount:5,disperseFactor:0,colorHiddenSides:"#222",sequentialFactor:150,speed:600,easing:"ease",autoplay:false,interval:3e3,fallbackFadeSpeed:300,onBeforeChange:function(e){return false},onAfterChange:function(e){return false},onReady:function(){return false}};e.Slicebox.prototype={_init:function(t){this.options=e.extend(true,{},e.Slicebox.defaults,t);this._validate();this.$items=this.$el.children("li");this.itemsCount=this.$items.length;if(this.itemsCount===0){return false}this.support=a.csstransitions&&a.csstransforms3d;this.current=0;this.isAnimating=false;this.isReady=false;var n=this;this.$el.imagesLoaded(function(){var e=n.$items.eq(n.current).css("display","block").addClass("sb-current");var t=new Image;t.src=e.find("img").attr("src");n.realWidth=t.width;n._setSize();n._setStyle();n._initEvents();n.options.onReady();n.isReady=true;if(n.options.autoplay){n._startSlideshow()}})},_validate:function(e){if(this.options.cuboidsCount<0){this.options.cuboidsCount=1}else if(this.options.cuboidsCount>15){this.options.cuboidsCount=15}else if(this.options.cuboidsCount%2===0){++this.options.cuboidsCount}if(this.options.maxCuboidsCount<0){this.options.maxCuboidsCount=1}else if(this.options.maxCuboidsCount>15){this.options.maxCuboidsCount=15}else if(this.options.maxCuboidsCount%2===0){++this.options.maxCuboidsCount}if(this.options.disperseFactor<0){this.options.disperseFactor=0}if(this.options.orientation!=="v"&&this.options.orientation!=="h"&&this.options.orientation!=="r"){this.options.orientation="v"}},_setSize:function(){var e=this.$items.eq(this.current).find("img");this.size={width:e.width(),height:e.height()}},_setStyle:function(){this.$el.css({"max-width":this.realWidth})},_initEvents:function(){var e=this;u.on("debouncedresize.slicebox",function(t){e._setSize()})},_startSlideshow:function(){var e=this;this.slideshow=setTimeout(function(){e._navigate("next");if(e.options.autoplay){e._startSlideshow()}},this.options.interval)},_stopSlideshow:function(){if(this.options.autoplay){clearTimeout(this.slideshow);this.isPlaying=false;this.options.autoplay=false}},_navigate:function(e,t){if(this.isAnimating||!this.isReady||this.itemsCount<2){return false}this.isAnimating=true;this.prev=this.current;if(t!==n){this.current=t}else if(e==="next"){this.current=this.current<this.itemsCount-1?this.current+1:0}else if(e==="prev"){this.current=this.current>0?this.current-1:this.itemsCount-1}this.options.onBeforeChange(this.current);if(!this.support){this._fade(e)}else{this._layout(e);this._rotate()}},_fade:function(t){var n=this,r=this.$items.eq(this.prev),i=r.find("img").height();this.$el.css("height",i);this.$items.css("position","absolute");this.$items.eq(this.current).fadeIn(this.options.fallbackFadeSpeed,function(){e(this).css("display","block").addClass("sb-current");n.$el.css("height","auto");n.$items.css("position","relative");n.isAnimating=false});n.$items.eq(n.prev).removeClass("sb-current").fadeOut(this.options.fallbackFadeSpeed)},_layout:function(t){var n=this.options.orientation;if(n==="r"){n=Math.floor(Math.random()*2)===0?"v":"h"}if(this.options.cuboidsRandom){this.options.cuboidsCount=Math.floor(Math.random()*this.options.maxCuboidsCount+1)}this._validate();var r={width:this.size.width,height:this.size.height,perspective:this.options.perspective+"px"},i=e.extend(this.options,{size:this.size,items:this.$items,direction:t,prev:this.prev,current:this.current,o:n}),s=this;this.$box=e("<div>").addClass("sb-perspective").css(r).appendTo(this.$el);this.cuboids=[];this.$el.css("overflow","visible");for(var o=0;o<this.options.cuboidsCount;++o){var u=new e.Cuboid(i,o);this.$box.append(u.getEl());this.cuboids.push(u)}},_rotate:function(){this.$items.eq(this.prev).removeClass("sb-current").hide();for(var e=0;e<this.options.cuboidsCount;++e){var t=this.cuboids[e],n=this;t.rotate(function(e){if(e===n.options.cuboidsCount-1){n.$el.css("overflow","hidden");n.isAnimating=false;n.$box.remove();var t=n.$items.eq(n.current);t.css("display","block");setTimeout(function(){t.addClass("sb-current")},0);n.options.onAfterChange(n.current)}})}},_destroy:function(e){this.$el.off(".slicebox").removeData("slicebox");u.off(".slicebox");e.call()},add:function(e,t){this.$items=this.$items.add(e);this.itemsCount=this.$items.length;if(t){t.call(e)}},next:function(){this._stopSlideshow();this._navigate("next")},previous:function(){this._stopSlideshow();this._navigate("prev")},jump:function(e){e-=1;if(e===this.current||e>=this.itemsCount||e<0){return false}this._stopSlideshow();this._navigate(e>this.current?"next":"prev",e)},play:function(){if(!this.isPlaying){this.isPlaying=true;this._navigate("next");this.options.autoplay=true;this._startSlideshow()}},pause:function(){if(this.isPlaying){this._stopSlideshow()}},isActive:function(){return this.isAnimating},destroy:function(e){this._destroy(e)}};e.Cuboid=function(e,t){this.config=e;this.pos=t;this.side=1;this._setSize();this._configureStyles()};e.Cuboid.prototype={_setSize:function(){this.size={width:this.config.o==="v"?Math.floor(this.config.size.width/this.config.cuboidsCount):this.config.size.width,height:this.config.o==="v"?this.config.size.height:Math.floor(this.config.size.height/this.config.cuboidsCount)};this.extra=this.config.o==="v"?this.config.size.width-this.size.width*this.config.cuboidsCount:this.config.size.height-this.size.height*this.config.cuboidsCount},_configureStyles:function(){var t=Math.ceil(this.config.cuboidsCount/2),n=this.pos<t?{zIndex:(this.pos+1)*100,left:this.config.o==="v"?this.size.width*this.pos:0,top:this.config.o==="v"?0:this.size.height*this.pos}:{zIndex:(this.config.cuboidsCount-this.pos)*100,left:this.config.o==="v"?this.size.width*this.pos:0,top:this.config.o==="v"?0:this.size.height*this.pos};this.disperseFactor=this.config.disperseFactor*(this.pos+1-t);this.style=e.extend({"-webkit-transition":"-webkit-transform "+this.config.speed+"ms "+this.config.easing,"-moz-transition":"-moz-transform "+this.config.speed+"ms "+this.config.easing,"-o-transition":"-o-transform "+this.config.speed+"ms "+this.config.easing,"-ms-transition":"-ms-transform "+this.config.speed+"ms "+this.config.easing,transition:"transform "+this.config.speed+"ms "+this.config.easing},n,this.size);this.animationStyles={side1:this.config.o==="v"?{transform:"translate3d( 0, 0, -"+this.size.height/2+"px )"}:{transform:"translate3d( 0, 0, -"+this.size.width/2+"px )"},side2:this.config.o==="v"?{transform:"translate3d( 0, 0, -"+this.size.height/2+"px ) rotate3d( 1, 0, 0, -90deg )"}:{transform:"translate3d( 0, 0, -"+this.size.width/2+"px ) rotate3d( 0, 1, 0, -90deg )"},side3:this.config.o==="v"?{transform:"translate3d( 0, 0, -"+this.size.height/2+"px ) rotate3d( 1, 0, 0, -180deg )"}:{transform:"translate3d( 0, 0, -"+this.size.width/2+"px ) rotate3d( 0, 1, 0, -180deg )"},side4:this.config.o==="v"?{transform:"translate3d( 0, 0, -"+this.size.height/2+"px ) rotate3d( 1, 0, 0, -270deg )"}:{transform:"translate3d( 0, 0, -"+this.size.width/2+"px ) rotate3d( 0, 1, 0, -270deg )"}};var r=this.config.o==="v"?this.size.height:this.size.width;this.sidesStyles={frontSideStyle:{width:this.config.o==="v"?this.size.width+this.extra:this.size.width,height:this.config.o==="v"?this.size.height:this.size.height+this.extra,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 0, 1, 0, 0deg ) translate3d( 0, 0, "+r/2+"px )"},backSideStyle:{width:this.size.width,height:this.size.height,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 0, 1, 0, 180deg ) translate3d( 0, 0, "+r/2+"px ) rotateZ( 180deg )"},rightSideStyle:{width:r,height:this.config.o==="v"?this.size.height:this.size.height+this.extra,left:this.config.o==="v"?this.size.width/2-this.size.height/2:0,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 0, 1, 0, 90deg ) translate3d( 0, 0, "+this.size.width/2+"px )"},leftSideStyle:{width:r,height:this.config.o==="v"?this.size.height:this.size.height+this.extra,left:this.config.o==="v"?this.size.width/2-this.size.height/2:0,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 0, 1, 0, -90deg ) translate3d( 0, 0, "+this.size.width/2+"px )"},topSideStyle:{width:this.config.o==="v"?this.size.width+this.extra:this.size.width,height:r,top:this.config.o==="v"?0:this.size.height/2-this.size.width/2,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 1, 0, 0, 90deg ) translate3d( 0, 0, "+this.size.height/2+"px )"},bottomSideStyle:{width:this.config.o==="v"?this.size.width+this.extra:this.size.width,height:r,top:this.config.o==="v"?0:this.size.height/2-this.size.width/2,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 1, 0, 0, -90deg ) translate3d( 0, 0, "+this.size.height/2+"px )"}}},getEl:function(){this.$el=e("<div/>").css(this.style).css(this.animationStyles.side1).append(e("<div/>").addClass("sb-side").css(this.sidesStyles.frontSideStyle)).append(e("<div/>").addClass("sb-side").css(this.sidesStyles.backSideStyle)).append(e("<div/>").addClass("sb-side").css(this.sidesStyles.rightSideStyle)).append(e("<div/>").addClass("sb-side").css(this.sidesStyles.leftSideStyle)).append(e("<div/>").addClass("sb-side").css(this.sidesStyles.topSideStyle)).append(e("<div/>").addClass("sb-side").css(this.sidesStyles.bottomSideStyle));this._showImage(this.config.prev);return this.$el},_showImage:function(e){var t,n=this.config.items.eq(e),r={"background-size":this.config.size.width+"px "+this.config.size.height+"px"};r.backgroundImage="url("+n.find("img").attr("src")+")";switch(this.side){case 1:t=0;break;case 2:t=this.config.o==="v"?4:2;break;case 3:t=1;break;case 4:t=this.config.o==="v"?5:3;break}r.backgroundPosition=this.config.o==="v"?-(this.pos*this.size.width)+"px 0px":"0px -"+this.pos*this.size.height+"px";this.$el.children().eq(t).css(r)},rotate:function(e){var t=this,n;setTimeout(function(){if(t.config.direction==="next"){switch(t.side){case 1:n=t.animationStyles.side2;t.side=2;break;case 2:n=t.animationStyles.side3;t.side=3;break;case 3:n=t.animationStyles.side4;t.side=4;break;case 4:n=t.animationStyles.side1;t.side=1;break}}else{switch(t.side){case 1:n=t.animationStyles.side4;t.side=4;break;case 2:n=t.animationStyles.side1;t.side=1;break;case 3:n=t.animationStyles.side2;t.side=2;break;case 4:n=t.animationStyles.side3;t.side=3;break}}t._showImage(t.config.current);var r={},i={};if(t.config.o==="v"){r.left="+="+t.disperseFactor+"px";i.left="-="+t.disperseFactor+"px"}else if(t.config.o==="h"){r.top="+="+t.disperseFactor+"px";i.top="-="+t.disperseFactor+"px"}t.$el.css(n).animate(r,t.config.speed/2).animate(i,t.config.speed/2,function(){if(e){e.call(t,t.pos)}})},this.config.sequentialFactor*this.pos+30)}};var f=function(e){if(t.console){t.console.error(e)}};e.fn.slicebox=function(t){var n=e.data(this,"slicebox");if(typeof t==="string"){var r=Array.prototype.slice.call(arguments,1);this.each(function(){if(!n){f("cannot call methods on slicebox prior to initialization; "+"attempted to call method '"+t+"'");return}if(!e.isFunction(n[t])||t.charAt(0)==="_"){f("no such method '"+t+"' for slicebox self");return}n[t].apply(n,r)})}else{this.each(function(){if(n){n._init()}else{n=e.data(this,"slicebox",new e.Slicebox(t,this))}})}return n}})(jQuery,window)